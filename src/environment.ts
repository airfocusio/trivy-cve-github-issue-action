export function getEnvString(name: string, fallback?: string): string {
  const value = process.env[name]
  if (typeof value === 'string') {
    return value
  } else if (typeof fallback === 'string') {
    return fallback
  } else {
    throw new Error(`Environment variable ${name} is missing`)
  }
}

export function getEnvNumber(name: string, fallback?: number): number {
  const valueRaw = process.env[name]
  const valueStr = typeof valueRaw === 'string' ? valueRaw.trim() : ''
  if (valueStr) {
    const value = Number.parseInt(valueStr.trim(), 10)
    if (Number.isFinite(value)) {
      return value
    } else {
      throw new Error(`Environment variable ${name} is not an integer`)
    }
  } else if (typeof fallback === 'number') {
    return fallback
  } else {
    throw new Error(`Environment variable ${name} is missing`)
  }
}

export function getEnvBoolean(name: string, fallback?: boolean): boolean {
  const valueRaw = process.env[name]
  const valueStr = typeof valueRaw === 'string' ? valueRaw.trim() : ''
  if (valueStr) {
    if (['true', 'yes', '1'].indexOf(valueStr) >= 0) {
      return true
    } else if (['false', 'no', '0'].indexOf(valueStr) >= 0) {
      return false
    } else {
      throw new Error(`Environment variable ${name} is not a boolean`)
    }
  } else if (typeof fallback === 'boolean') {
    return fallback
  } else {
    throw new Error(`Environment variable ${name} is missing`)
  }
}
